# SPDX-License-Identifier: GPL-2.0
# Copyright (c) 2026 honeok <i@honeok.com>
#
# References:
# https://github.com/Repcz/Tool

mode: rule # è§„åˆ™æ¨¡å¼: rule (è§„åˆ™) / global (å…¨å±€ä»£ç†) / direct (å…¨å±€ç›´è¿)

# 5 ä¸ªçº§åˆ«: silent / info / warning / error / debug çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ è¶Šå€¾å‘äºè°ƒè¯• è‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯
log-level: warning

## DNSæœåŠ¡å™¨é…ç½®
dns:
  # ä»¥ä¸‹å¡«å†™çš„DNSæœåŠ¡å™¨å°†ä¼šè¢«ç”¨æ¥è§£æDNSæœåŠ¡çš„åŸŸå
  # ä»…å¡«å†™DNSæœåŠ¡å™¨çš„IPåœ°å€
  default-nameserver:
    - 119.29.29.29
    - 223.5.5.5
    - system # ä½¿ç”¨iOSç³»ç»ŸDNS

  # æ”¯æŒUDP / TCP / DoT / DoHåè®®çš„DNSæœåŠ¡å¯ä»¥æŒ‡æ˜å…·ä½“çš„è¿æ¥ç«¯å£å·
  # æ‰€æœ‰DNSè¯·æ±‚å°†ä¼šç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ä¸ç»è¿‡ä»»ä½•ä»£ç†
  # Stashä¼šä½¿ç”¨æœ€å…ˆè·å¾—çš„è§£æè®°å½•å›å¤DNSè¯·æ±‚
  nameserver:
    - https://one.one.one.one/dns-query
    - https://dns.google/dns-query

  # è·³è¿‡è¯ä¹¦éªŒè¯ï¼Œè§£å†³éƒ¨åˆ†å…¼å®¹æ€§é—®é¢˜ https://help.nextdns.io/t/g9hdkjz
  # skip-cert-verify: true

## æœºåœºé€šç”¨é…ç½®æ¨¡æ¿
airport_conf: &airport_conf
  type: http
  interval: 3600 # è‡ªåŠ¨æ›´æ–°æ—¶é—´(ç§’)
  proxy: DIRECT # é€šè¿‡ç›´è¿æ‹‰å–æœºåœºè®¢é˜…, è¯¥åå­—æ˜¯æŒ‡ç­–ç•¥ç»„æˆ–æŸä¸ªä»£ç†èŠ‚ç‚¹çš„åå­—
  lazy: true # æ‡’åŠ è½½
  health-check: # èŠ‚ç‚¹è‡ªåŠ¨æ£€æµ‹å»¶æ—¶
    enable: true
    interval: 300
    url: "http://connectivitycheck.gstatic.com/generate_204"

# ç­–ç•¥ç»„å¼•ç”¨åˆ—è¡¨
Airports: &airports
  use:
    - Airport1
    - Airport2

# æœºåœºè®¢é˜…åˆé›†
proxy-providers:
  Airport1:
    <<: *airport_conf
    url: "url1"
  Airport2:
    <<: *airport_conf
    url: "url2"

## ä»£ç†åˆ†ç»„é”šç‚¹
main: &main { type: select, include-all: true, proxies: [ğŸš€ é»˜è®¤ä»£ç†, â™»ï¸ è‡ªåŠ¨é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯è‡ªåŠ¨, ğŸ‡¹ğŸ‡¼ å°æ¹¾è‡ªåŠ¨, ğŸ‡¸ğŸ‡¬ ç‹®åŸè‡ªåŠ¨, ğŸ‡¯ğŸ‡µ æ—¥æœ¬è‡ªåŠ¨, ğŸ‡ºğŸ‡¸ ç¾å›½è‡ªåŠ¨, ğŸ‡³ğŸ‡± è·å…°è‡ªåŠ¨, ğŸ‡©ğŸ‡ª å¾·å›½è‡ªåŠ¨, DIRECT] }
proxy: &proxy { type: select, include-all: true, proxies: [ğŸš€ é»˜è®¤ä»£ç†, â™»ï¸ è‡ªåŠ¨é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯è‡ªåŠ¨, ğŸ‡¹ğŸ‡¼ å°æ¹¾è‡ªåŠ¨, ğŸ‡¸ğŸ‡¬ ç‹®åŸè‡ªåŠ¨, ğŸ‡¯ğŸ‡µ æ—¥æœ¬è‡ªåŠ¨, ğŸ‡ºğŸ‡¸ ç¾å›½è‡ªåŠ¨, ğŸ‡³ğŸ‡± è·å…°è‡ªåŠ¨, ğŸ‡©ğŸ‡ª å¾·å›½è‡ªåŠ¨] }
specific: &specific { type: select, include-all: true, <<: *airports, filter: "^((?!(?i)(ğŸ‡­ğŸ‡°|é¦™æ¸¯|hk|hong\\s?kong|ğŸ‡²ğŸ‡´|æ¾³é—¨|æ¾³é–€|macau|macao|ğŸ‡·ğŸ‡º|ä¿„ç½—æ–¯|ru|russia|ğŸ‡¨ğŸ‡³|ä¸­å›½|å›å›½|china|cn)).)*$" }
island: &island { type: select, proxies: [DIRECT], <<: *airports, filter: "(?i)(ğŸ‡­ğŸ‡°|é¦™æ¸¯|hk|hong\\s?kong|ğŸ‡²ğŸ‡´|æ¾³é—¨|æ¾³é–€|macau|macao|ğŸ‡¹ğŸ‡¼|å°æ¹¾|å°ç£|tw|taiwan|taipei)" }

## ä»£ç†åˆ†ç»„
proxy-groups:
  #------------------------åŸºç¡€åˆ†ç»„------------------------#
  - { name: ğŸš€ é»˜è®¤ä»£ç†, type: select, include-all: true, proxies: [â™»ï¸ è‡ªåŠ¨é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯è‡ªåŠ¨, ğŸ‡¹ğŸ‡¼ å°æ¹¾è‡ªåŠ¨, ğŸ‡¸ğŸ‡¬ ç‹®åŸè‡ªåŠ¨, ğŸ‡¯ğŸ‡µ æ—¥æœ¬è‡ªåŠ¨, ğŸ‡ºğŸ‡¸ ç¾å›½è‡ªåŠ¨, ğŸ‡³ğŸ‡± è·å…°è‡ªåŠ¨, ğŸ‡©ğŸ‡ª å¾·å›½è‡ªåŠ¨], icon: "https://fastly.jsdelivr.net/gh/shindgewongxj/WHATSINStash@main/icon/select.png" }
  - { name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©, type: url-test, include-all: true, tolerance: 100, url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Auto.png", interval: 300 }

  #------------------------åœºæ™¯åˆ†ç»„------------------------#
  - { name: ğŸ¤– AI, <<: *specific, icon: "https://fastly.jsdelivr.net/gh/Orz-3/mini@master/Color/OpenAI.png" }
  - { name: ğŸ€ Google, <<: *proxy, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Google_Search.png" }
  - { name: ğŸ‘¨â€ğŸ’» GitHub, <<: *proxy, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/GitHub.png" }
  - { name: ğŸ¦Š GitLab, <<: *proxy, icon: "https://about.gitlab.com/images/press/logo/png/gitlab-icon-rgb.png" }
  - { name: ğŸ³ Docker, <<: *proxy, icon: "https://www.docker.com/app/uploads/2022/03/Moby-logo.png" }
  - { name: ğŸªŸ Microsoft, <<: *main, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Microsoft.png" }
  - { name: ğŸ¬ OneDrive, <<: *main, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/OneDrive.png" }
  - { name: ğŸ“² Telegram, <<: *proxy, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Telegram.png" }
  - { name: ğŸ“º BiliBili, <<: *island, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/bilibili.png" }
  - { name: ğŸ¥ NETFLIX, <<: *specific, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Netflix.png" }
  - { name: ğŸ§ Spotify, <<: *island, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Spotify.png" }
  - { name: ğŸµ TikTok, <<: *specific, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/TikTok.png" }
  - { name: ğŸ’¶ PayPal, <<: *main, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/PayPal.png" }
  - { name: âœˆï¸ Speedtest, <<: *main, icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Speedtest.png" }
  - { name: ğŸ Apple, <<: *main, icon: "https://fastly.jsdelivr.net/gh/shindgewongxj/WHATSINStash@main/icon/appleclassic.png" }

  #------------------------åœ°åŒºåˆ†ç»„------------------------#
  - { name: ğŸ‡­ğŸ‡° é¦™æ¸¯è‡ªåŠ¨, type: url-test, <<: *airports, include-all: true, tolerance: 100, filter: "(?i)(ğŸ‡­ğŸ‡°|é¦™æ¸¯|hk|hong\\s?kong)", url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://flagcdn.com/w320/hk.png", interval: 300 }
  - { name: ğŸ‡¹ğŸ‡¼ å°æ¹¾è‡ªåŠ¨, type: url-test, <<: *airports, include-all: true, tolerance: 100, filter: "(?i)(ğŸ‡¹ğŸ‡¼|å°æ¹¾|tw|taiwan|taipei)", url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://flagcdn.com/w320/tw.png", interval: 300 }
  - { name: ğŸ‡¸ğŸ‡¬ ç‹®åŸè‡ªåŠ¨, type: url-test, <<: *airports, include-all: true, tolerance: 100, filter: "(?i)(ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|sg|singapore|lion\\s?city)", url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://flagcdn.com/w320/sg.png", interval: 300 }
  - { name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬è‡ªåŠ¨, type: url-test, <<: *airports, include-all: true, tolerance: 100, filter: "(?i)(ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|jp|japan|tokyo|osaka)", url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://flagcdn.com/w320/jp.png", interval: 300 }
  - { name: ğŸ‡ºğŸ‡¸ ç¾å›½è‡ªåŠ¨, type: url-test, <<: *airports, include-all: true, tolerance: 100, filter: "(?i)(ğŸ‡ºğŸ‡¸|ç¾å›½|us|united\\s?states|america)", url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://flagcdn.com/w320/us.png", interval: 300 }
  - { name: ğŸ‡³ğŸ‡± è·å…°è‡ªåŠ¨, type: url-test, <<: *airports, include-all: true, tolerance: 100, filter: "(?i)(ğŸ‡³ğŸ‡±|è·å…°|nl|netherlands|amsterdam)", url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://flagcdn.com/w320/nl.png", interval: 300 }
  - { name: ğŸ‡©ğŸ‡ª å¾·å›½è‡ªåŠ¨, type: url-test, <<: *airports, include-all: true, tolerance: 100, filter: "(?i)(ğŸ‡©ğŸ‡ª|å¾·å›½|de|germany|frankfurt)", url: "http://connectivitycheck.gstatic.com/generate_204", icon: "https://flagcdn.com/w320/de.png", interval: 300 }

  #------------------------ç‰¹æ®Šåˆ†ç»„------------------------#
  - { name: ğŸ¯ å…¨çƒç›´è¿, type: select, proxies: [DIRECT, ğŸš€ é»˜è®¤ä»£ç†], icon: "https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Direct.png" }
  - { name: ğŸ£ æ¼ç½‘ä¹‹é±¼, <<: *main, icon: "https://fastly.jsdelivr.net/gh/shindgewongxj/WHATSINStash@main/icon/friestash.png" }

## è§„åˆ™åŒ¹é…
rules:
  # æœ¬åœ°å±€åŸŸç½‘
  - RULE-SET,private_ip,DIRECT,no-resolve
  - RULE-SET,private_domain,DIRECT

  # å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,ads_domain,REJECT

  # åº”ç”¨åˆ†æµ
  - RULE-SET,apple_cn_domain,DIRECT
  - RULE-SET,apple_domain,ğŸ Apple
  - RULE-SET,google_domain,ğŸ€ Google
  - RULE-SET,ai_domain,ğŸ¤– AI
  - RULE-SET,github_domain,ğŸ‘¨â€ğŸ’» GitHub
  - RULE-SET,gitlab_domain,ğŸ¦Š GitLab
  - RULE-SET,docker_domain, ğŸ³ Docker
  - RULE-SET,microsoft_domain,ğŸªŸ Microsoft
  - RULE-SET,onedrive_domain,ğŸ¬ OneDrive
  - RULE-SET,telegram_domain,ğŸ“² Telegram
  - RULE-SET,bilibili_domain,ğŸ“º BiliBili
  - RULE-SET,netflix_domain,ğŸ¥ NETFLIX
  - RULE-SET,spotify_domain,ğŸ§ Spotify
  - RULE-SET,tiktok_domain,ğŸµ TikTok
  - RULE-SET,paypal_domain,ğŸ’¶ PayPal
  - RULE-SET,speedtest_domain,âœˆï¸ Speedtest

  - RULE-SET,cn_ip,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,cn_domain,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,direct_domain,DIRECT
  - RULE-SET,geolocation-!cn,ğŸš€ é»˜è®¤ä»£ç†

  - RULE-SET,google_ip,ğŸ€ Google,no-resolve
  - RULE-SET,telegram_ip,ğŸ“² Telegram,no-resolve
  - RULE-SET,netflix_ip,ğŸ¥ NETFLIX,no-resolve

  # å…œåº•è§„åˆ™
  - MATCH,ğŸ£ æ¼ç½‘ä¹‹é±¼

## è§„åˆ™é›†
rule-anchor:
  ip: &ip { type: http, interval: 86400, behavior: ipcidr, format: mrs }
  domain: &domain { type: http, interval: 86400, behavior: domain, format: mrs }

## è®¢é˜…è§„åˆ™
rule-providers:
  ai_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-ai-!cn.mrs" }
  ads_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/TG-Twilight/AWAvenue-Ads-Rule@main/Filters/AWAvenue-Ads-Rule-Clash.mrs" }
  apple_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/apple.mrs" }
  apple_cn_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/apple-cn.mrs" }
  bilibili_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/bilibili.mrs" }
  cn_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.mrs" }
  direct_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/wwqgtxx/clash-rules@release/direct.mrs" }
  docker_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/docker.mrs" }
  fakeipfilter_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/wwqgtxx/clash-rules@release/fakeip-filter.mrs" }
  geolocation-!cn: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/geolocation-!cn.mrs" }
  github_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/github.mrs" }
  gitlab_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/gitlab.mrs" }
  google_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/google.mrs" }
  microsoft_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/microsoft.mrs" }
  netflix_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/netflix.mrs" }
  onedrive_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/onedrive.mrs" }
  paypal_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/paypal.mrs" }
  private_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.mrs" }
  speedtest_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/speedtest.mrs" }
  spotify_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/spotify.mrs" }
  telegram_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.mrs" }
  tiktok_domain: { <<: *domain, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/tiktok.mrs" }

  cn_ip: { <<: *ip, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.mrs" }
  google_ip: { <<: *ip, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/google.mrs" }
  netflix_ip: { <<: *ip, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/netflix.mrs" }
  private_ip: { <<: *ip, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/private.mrs" }
  telegram_ip: { <<: *ip, url: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.mrs" }
